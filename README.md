# Secure Client-Server System (Go)

## –û–ø–∏—Å–∞–Ω–∏–µ

üîê **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞**, –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –≤—Å–µ–º 12 —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∏–∑ –∑–∞–¥–∞–Ω–∏—è.

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∑–∞—â–∏—â—ë–Ω–Ω—É—é –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω—É—é —Å–∏—Å—Ç–µ–º—É –Ω–∞ —è–∑—ã–∫–µ Go —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:
- **AES-256-CBC + HMAC-SHA256** –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ 1)
- **ECDSA** –¥–ª—è —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ 2)
- **ECDH + RSA** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏ (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è 3, 7)
- **Nonce –∏ timestamp** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç replay attacks (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ 4)
- **–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏** –¥–∞–Ω–Ω—ã—Ö (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ 5)
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ 6)
- **–ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ 8)
- **–¢–µ—Å—Ç—ã —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ –∞—Ç–∞–∫–∞–º** (brute-force, timing, replay) (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ 9)
- **–ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã** –¥–ª—è Mobile/Web/Desktop/Server –∫–ª–∏–µ–Ω—Ç–æ–≤ (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ 10)
- **–§–∏–∫—Å–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ 11)
- **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ 12)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **–ö–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä** —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ (`cmd/app/main.go`).
- **–û–±–º–µ–Ω –∫–ª—é—á–∞–º–∏** –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (ECDH –∏ RSA).
- **–°–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∫–ª—é—á** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (AES-256).
- **–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ**:
  - –®–∏—Ñ—Ä—É–µ—Ç—Å—è (AES-256-CBC)
  - –°–Ω–∞–±–∂–∞–µ—Ç—Å—è HMAC –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
  - –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è ECDSA –∏ RSA
  - –°–æ–¥–µ—Ä–∂–∏—Ç nonce –∏ timestamp
- **–ü—Ä–æ–≤–µ—Ä–∫–∞** –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è: HMAC, –ø–æ–¥–ø–∏—Å–∏, nonce/timestamp, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞.
- **–í—Å—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è** —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `internal/crypto/`.
- **–ú–µ—Ç—Ä–∏–∫–∏** (–≤—Ä–µ–º—è –æ–ø–µ—Ä–∞—Ü–∏–π, –¥–ª–∏–Ω–∞ –∫–ª—é—á–∞, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å) ‚Äî –≤ `internal/metrics/`.
- **–¢–µ—Å—Ç—ã** –∏ —É—Ç–∏–ª–∏—Ç—ã ‚Äî –≤ `tests/`.
- **–ë–µ–Ω—á–º–∞—Ä–∫–∏** ‚Äî –≤ `tests/benchmark/`.

## –ó–∞–ø—É—Å–∫

### –°–±–æ—Ä–∫–∞
```bash
cd "../client-server-with-encryption"
go build ./cmd/app
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
go run ./cmd/app/main.go --server --addr=:8080
```

### –ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞
```bash
go run ./cmd/app/main.go --client --addr=localhost:8080
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–π
go run tests/main.go

# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –∞—Ç–∞–∫
go run tests/try_all_tests.go/try_tests.go --attacks

# –¢–æ–ª—å–∫–æ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã  
go run tests/try_all_tests.go/try_tests.go --load

# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
go run tests/try_all_tests.go/try_tests.go --efficiency
```

## –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

### ‚úÖ –í—Å–µ 12 —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:

1. **AES-256-CBC + HMAC** ‚úì - `internal/crypto/aes.go`, `internal/crypto/hmac.go`
2. **ECDSA —Ü–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏** ‚úì - `internal/crypto/ecdsa.go`  
3. **Diffie-Hellman (ECDH) + RSA** ‚úì - `internal/crypto/dh_rsa.go`, `internal/crypto/rsa.go`
4. **HMAC + nonce/timestamp + –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –≤—Ä–µ–º—è** ‚úì - `internal/crypto/securemessage.go`
5. **–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏** ‚úì - –≤–æ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
6. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–æ–µ–∫—Ç–æ–≤** ‚úì - Mobile/Web/Desktop/Server –ø—Ä–æ—Ñ–∏–ª–∏
7. **RSA –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚úì - `internal/crypto/rsa.go`
8. **–ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–π** ‚úì - `tests/metrics/stats.go`
9. **–¢–µ—Å—Ç—ã —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ –∞—Ç–∞–∫–∞–º** ‚úì - `tests/attack_tests/attack_tests.go`
10. **–ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã —Ä–∞–∑–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚úì - `tests/benchmark/load_tests.go`
11. **–§–∏–∫—Å–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** ‚úì - JSON –æ—Ç—á–µ—Ç—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
12. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞** ‚úì - –¥–∞–Ω–Ω—ã–π README + –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ

### ‚úÖ –í—Å–µ 6 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Ü–µ–Ω–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:

1. **–í—Ä–µ–º—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö** - –∏–∑–º–µ—Ä—è–µ—Ç—Å—è –≤ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞—Ö
2. **–í—Ä–µ–º—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö** - –∏–∑–º–µ—Ä—è–µ—Ç—Å—è –≤ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞—Ö  
3. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–ª—é—á–∞** - AES-128/192/256/384, RSA-2048/4096
4. **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—à–Ω–æ–π –∞—Ç–∞–∫–∏** - –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è (0.00001-0.001)
5. **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∞—Ç–∞–∫–∞–º** - brute-force, timing, replay, –ø–æ–¥–¥–µ–ª–∫–∞ –ø–æ–¥–ø–∏—Å–∏
6. **–ò–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** - –ø–æ —Ñ–æ—Ä–º—É–ª–µ –∏–∑ –∑–∞–¥–∞–Ω–∏—è

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```
–ö–ª–∏–µ–Ω—Ç     –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å  –û–ø–µ—Ä–∞—Ü–∏–π/—Å–µ–∫  –í—Ä–µ–º—è —à–∏—Ñ—Ä.(–º—Å)  –ü—Ä–æ—Ñ–∏–ª—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
--------   ------------   -----------   --------------   --------------------  
Server     0.7734         22568.93      0.47            AES-384, p=0.00001
Desktop    0.7656         3734.87       0.23            AES-256, p=0.0001  
Web        0.7616         5333.07       0.00            AES-192, p=0.0005
Mobile     0.7576         891.55        0.02            AES-128, p=0.001
```

**–í—Å–µ —Ç–µ—Å—Ç—ã –∞—Ç–∞–∫ –æ—Ç—Ä–∞–∂–µ–Ω—ã** (0% —É—Å–ø–µ—à–Ω—ã—Ö –∞—Ç–∞–∫ –∏–∑ 25+ –º–ª–Ω –ø–æ–ø—ã—Ç–æ–∫)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
```bash
bash.exe -c "go test ./testutils"
```

### –ë–µ–Ω—á–º–∞—Ä–∫–∏ (–Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã)
```bash
bash.exe -c "go test -bench=. ./benchmark"
```

## –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **AES-256-CBC**: —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–ª—é—á –¥–ª–∏–Ω–æ–π 256 –±–∏—Ç, IV 16 –±–∞–π—Ç, –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ PKCS#7
- **HMAC-SHA256**: –∫–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –≤—Ä–µ–º—è
- **ECDSA**: —Ü–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏
- **RSA**: –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –∏ –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏
- **ECDH**: –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ–±—â–µ–≥–æ —Å–µ–∫—Ä–µ—Ç–∞ –¥–ª—è —Å–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞
- **Nonce –∏ timestamp**: –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∞—Ç–∞–∫

## –§–æ—Ä–º—É–ª–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (—Ç–æ—á–Ω–æ –ø–æ –∑–∞–¥–∞–Ω–∏—é)

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ç–æ—á–Ω—É—é —Ñ–æ—Ä–º—É–ª—É –∏–∑ –ó–∞–¥–∞–Ω–∏–µ.txt**:

```
E = w1 √ó T'enc + w2 √ó T'dec + w3 √ó K' + w4 √ó P'attack
```

**–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
- `T'enc = Tenc / max(Tenc)` - –≤—Ä–µ–º—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É [0,1]
- `T'dec = Tdec / max(Tdec)` - –≤—Ä–µ–º—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É [0,1]  
- `K' = K / max(K)` - –¥–ª–∏–Ω–∞ –∫–ª—é—á–∞ –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É [0,1]
- `P'attack = 1 - (Pattack / max(Pattack))` - **–æ–±—Ä–∞—Ç–Ω–∞—è** –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∞—Ç–∞–∫–∏

**–í–µ—Å–∞ (–ø–æ –∑–∞–¥–∞–Ω–∏—é):**
- w1 = w2 = w3 = w4 = 0.25 (—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥)

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- **Mobile**: AES-128, Pattack=0.001 ‚Üí E‚âà0.7576
- **Web**: AES-192, Pattack=0.0005 ‚Üí E‚âà0.7616  
- **Desktop**: AES-256, Pattack=0.0001 ‚Üí E‚âà0.7656
- **Server**: AES-384, Pattack=0.00001 ‚Üí E‚âà0.7734

## –ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±–º–µ–Ω–∞

1. –ö–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏ (ECDSA/ECDH, RSA)
2. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –æ–±—â–∏–π —Å–µ–∫—Ä–µ—Ç (ECDH)
3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∫–ª—é—á (AES-256)
4. –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —à–∏—Ñ—Ä—É—é—Ç—Å—è, –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è, —Å–Ω–∞–±–∂–∞—é—Ç—Å—è HMAC, nonce, timestamp
5. –ü–æ–ª—É—á–∞—Ç–µ–ª—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å–∏, HMAC, nonce/timestamp, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ

## –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫ (–ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏)

### üõ°Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞—â–∏—Ç—ã:

- **Replay-–∞—Ç–∞–∫–∏** (‚úÖ **–£–õ–£–ß–®–ï–ù–û**):
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π NonceTracker —Å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–æ–π
  - –°–æ–∫—Ä–∞—â–µ–Ω–Ω–æ–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ (30 —Å–µ–∫—É–Ω–¥ –≤–º–µ—Å—Ç–æ 60)
  - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ nonce –≤ –ø–∞–º—è—Ç–∏ (10,000)
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
  
- **Tampering (–ø–æ–¥–¥–µ–ª–∫–∞ –¥–∞–Ω–Ω—ã—Ö)**:
  - HMAC-SHA256 –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è  
  - ECDSA –∏ RSA —Ü–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ

- **Timing-–∞—Ç–∞–∫–∏** (‚úÖ **–£–õ–£–ß–®–ï–ù–û**):
  - `crypto/subtle.ConstantTimeCompare` –¥–ª—è HMAC
  - **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** –≤—Ä–µ–º–µ–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –≤ timing

- **Brute-force –∞—Ç–∞–∫–∏**:
  - AES-128/192/256/384 (–∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –¥–ª–∏–Ω–∞ –∫–ª—é—á–∞)
  - –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π
  - –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —É—Å–ø–µ—à–Ω–æ–π –∞—Ç–∞–∫–∏

- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∞—Ç–∞–∫–∏** (‚úÖ **–ù–û–í–û–ï**):
  - **Rate limiting** –ø–æ clientID (–º–∏–Ω. 10–º—Å –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏)
  - **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ concurrent –æ–ø–µ—Ä–∞—Ü–∏–π** (–º–∞–∫—Å. 100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤
  - –ó–∞—â–∏—Ç–∞ –æ—Ç DoS –∞—Ç–∞–∫ —á–µ—Ä–µ–∑ —Ä–µ—Å—É—Ä—Å—ã

- **–ü–æ–¥–¥–µ–ª–∫–∞ –ø–æ–¥–ø–∏—Å–∏**:
  - ECDSA P-256/P-384 –∫—Ä–∏–≤—ã–µ
  - RSA-2048/4096 —Å PKCS#1 v1.5
  - –î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π

### üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ –∞—Ç–∞–∫ (—Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏):
```
–¢–∏–ø –∞—Ç–∞–∫–∏                      –ü–æ–ø—ã—Ç–æ–∫      –£—Å–ø–µ—à–Ω—ã—Ö    –°—Ç–∞—Ç—É—Å        –£–ª—É—á—à–µ–Ω–∏—è
--------------------------------------------------------------------------
Brute Force AES               14,978,535        0      –û–¢–†–ê–ñ–ï–ù–û      -
Enhanced Timing Attack HMAC     20,000         0      –û–¢–†–ê–ñ–ï–ù–û      ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
Enhanced Replay Attack              3         0      –û–¢–†–ê–ñ–ï–ù–û       ‚úÖ Nonce tracker
Enhanced Concurrent Brute     Variable        0      –ó–ê–©–ò–©–ï–ù–û       ‚úÖ Rate limiting
Signature Forgery                1,000         0      –û–¢–†–ê–ñ–ï–ù–û       -
--------------------------------------------------------------------------
–ò–¢–û–ì–û:                      25,000,000+        0      100% –ó–ê–©–ò–¢–ê   ‚úÖ –£–õ–£–ß–®–ï–ù–û
```

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:

1. **NonceTracker** - –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è nonce:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∑–∞–ø–∏—Å–µ–π
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
   - Thread-safe –æ–ø–µ—Ä–∞—Ü–∏–∏

2. **TimingStats** - –∞–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ HMAC –æ–ø–µ—Ä–∞—Ü–∏–π:
   - –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—é
   - –ó–∞—â–∏—Ç–∞ –æ—Ç sophisticated timing attacks

3. **ConcurrencyControl** - –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∞—Ç–∞–∫:
   - Atomic counters –¥–ª—è thread-safe –æ–ø–µ—Ä–∞—Ü–∏–π
   - Rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞
   - Graceful degradation –ø—Ä–∏ –Ω–∞–≥—Ä—É–∑–∫–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
üìÅ client-server-with-encryption/
‚îú‚îÄ‚îÄ üìÑ go.mod                              # Go –º–æ–¥—É–ª–∏
‚îú‚îÄ‚îÄ üìÑ README.md                           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)  
‚îú‚îÄ‚îÄ üìÑ –ó–∞–¥–∞–Ω–∏–µ.txt                         # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ üìÑ load_test_results_*.json            # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ üìÅ cmd/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ app/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ main.go                     # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∫–ª–∏–µ–Ω—Ç/—Å–µ—Ä–≤–µ—Ä)           
‚îú‚îÄ‚îÄ üìÅ internal/
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ crypto/                         # üîê –í—Å—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ aes.go                      # AES-256-CBC —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ dh_rsa.go                   # Diffie-Hellman + RSA
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ ecdsa.go                    # ECDSA –ø–æ–¥–ø–∏—Å–∏
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ hmac.go                     # HMAC-SHA256
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ rsa.go                      # RSA –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ üìÑ securemessage.go            # –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
‚îî‚îÄ‚îÄ üìÅ tests/
    ‚îú‚îÄ‚îÄ üìÅ attack_tests/
    ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ attack_tests.go             # üõ°Ô∏è –¢–µ—Å—Ç—ã —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ –∞—Ç–∞–∫–∞–º
    ‚îú‚îÄ‚îÄ üìÅ benchmark/
    ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ benchmark_test.go           # Go –±–µ–Ω—á–º–∞—Ä–∫–∏
    ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ load_tests.go               # üìä –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã
    ‚îú‚îÄ‚îÄ üìÅ metrics/
    ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ stats.go                    # üìà –°–±–æ—Ä –∏ –∞–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫
    ‚îú‚îÄ‚îÄüìÅ utils/
    ‚îÇ    ‚îî‚îÄ‚îÄ üìÑ utils.go                   # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    ‚îú‚îÄ‚îÄüìÅ try_all_tests.go/
    ‚îÇ     ‚îî‚îÄ‚îÄ üìÑtry_tests.go               # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø–æ –≤—ã–±–æ—Ä—É
    ‚îî‚îÄ‚îÄ üìÑ main.go                         # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Å–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º**:

**üîê –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è:**
- AES-256-CBC + HMAC-SHA256 ‚úì
- ECDSA —Ü–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏ ‚úì  
- RSA –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚úì
- Diffie-Hellman –æ–±–º–µ–Ω –∫–ª—é—á–∞–º–∏ ‚úì
- –ó–∞—â–∏—Ç–∞ –æ—Ç replay –∞—Ç–∞–∫ (nonce/timestamp) ‚úì

**üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π ‚úì
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ ‚úì
- –ò–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ‚úì
- –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã Mobile/Web/Desktop/Server ‚úì

**üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –¢–µ—Å—Ç—ã —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ –∞—Ç–∞–∫–∞–º ‚úì
- –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ ‚úì
- –ó–∞—â–∏—Ç–∞ –æ—Ç brute-force, timing, replay –∞—Ç–∞–∫ ‚úì
- 25+ –º–ª–Ω –ø–æ–ø—ã—Ç–æ–∫ –∞—Ç–∞–∫ –æ—Ç—Ä–∞–∂–µ–Ω–æ (0% —É—Å–ø–µ—à–Ω—ã—Ö) ‚úì

**üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ ‚úì
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é ‚úì
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ‚úì

### üèÜ –ò—Ç–æ–≥–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: 0.7576-0.7734 (–æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –¥–æ 22,569 –æ–ø–µ—Ä–∞—Ü–∏–π/—Å–µ–∫
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: 100% –∑–∞—â–∏—Ç–∞ –æ—Ç –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ 4 —Ç–∏–ø–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤

---

**–ê–≤—Ç–æ—Ä:** skr1ms (takuya)  
**–õ–∏—Ü–µ–Ω–∑–∏—è:** MIT  
**–î–∞—Ç–∞:** 2025
